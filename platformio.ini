[platformio]
default_envs = esp32dev
src_dir = src
include_dir = include
lib_dir = lib
data_dir = data
build_dir = .piobuild

; --- Environnement de Base ---
[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

; Configuration Série (Valeurs forcées à 1 comme entiers)
monitor_speed = 115200
monitor_dtr = 1
monitor_rts = 1
upload_speed = 460800

; Optimisations Debug
build_flags =
    -D DEBUG=1
    -O2
    -Wall

; --- Environnement Release ---
[env:esp32dev_release]
; On ré-explicite la plateforme pour éviter l'erreur "UndefinedEnvPlatformError"
platform = espressif32
board = esp32dev
framework = arduino
extends = esp32dev

; Optimisations Release (Écrase les flags du parent)
build_flags =
    -I include
    -D DEBUG=0
    -O3

; --- Environnement Test ---
[env:test]
platform = espressif32
board = esp32dev
framework = arduino
build_flags = -D UNITTEST=1
